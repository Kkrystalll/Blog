---
title: Docker - ç®¡ç† Docker Container(å®¹å™¨) çš„ç”Ÿå‘½å‘¨æœŸ
tags:
  - Docker
  - éƒ¨ç½²
  - container
comments: false
toc: true
cover: /image/docker.webp
categories:
  - Docker
  - éƒ¨ç½²
date: 2023-09-20 00:31:03
---

## Docker Container çš„å•Ÿå‹•ã€é–‹å§‹ã€åœæ­¢ã€åˆªé™¤

### å•Ÿå‹• Container

ç•¶æˆ‘å€‘æƒ³è¦åŸ·è¡Œä¸€å€‹ Container å®¹å™¨æ™‚ï¼Œæœƒä½¿ç”¨ `docker run` é€™å€‹æŒ‡ä»¤ï¼Œé€™å€‹æŒ‡ä»¤æœƒå¾æˆ‘æœ¬åœ°çš„ image æˆ– Docker Hub å„²å­˜åº«ä¸­ä¸‹è¼‰åç‚º ruby çš„ image ï¼Œç„¶å¾Œä½¿ç”¨é€™å€‹ image å»ºç«‹ä¸€å€‹æ–°çš„ container ä¸¦åŸ·è¡Œå®ƒã€‚

```
docker run ruby
```

ä»¥ä¸Šé¢çš„æŒ‡ä»¤ç‚ºä¾‹ï¼Œæœƒå…ˆçœ‹æˆ‘æœ¬åœ°æ˜¯å¦æœ‰åç‚º `ruby` çš„ image ï¼Œè‹¥æœ‰å°±æ ¹æ“šé€™å€‹ image ç”Ÿæˆ container ä¸¦åŸ·è¡Œå®ƒ ; è‹¥ç„¡ï¼Œå°±å» Docker Hub å„²å­˜åº«ä¸­ä¸‹è¼‰åç‚º ruby çš„ image ï¼Œç„¶å¾Œå»ºç«‹æ–°çš„ container ä¸¦åŸ·è¡Œå®ƒã€‚
![Docker run](/image/dockerDay5/5_1.png)

æ ¹æ“šä¸Šé¢æˆªåœ–çš„ç¬¬ä¸€å¥å¯ä»¥çœ‹åˆ° `Unable to find image 'ruby:latest' locally` ä»£è¡¨æœ¬åœ°æ²’æœ‰æ‰¾åˆ° `ruby:latest` çš„ image ï¼Œæ‰€ä»¥å¯ä»¥çœ‹åˆ°ç¬¬äºŒå¥ `latest: Pulling from library/ruby` ï¼Œä»£è¡¨å¾ Docker Hub çš„ library/ruby å­˜å„²åº«ä¸­ä¸‹è¼‰ `ruby:latest` æ˜ åƒã€‚
![Docker run è‡ªå‹•ä¸‹è¼‰ latest](/image/dockerDay5/5_2.png)

ç„¶å¾ŒåŸ·è¡Œå®Œæˆæˆ‘å¯ä»¥å¯ä»¥çœ‹åˆ°ä¸Šé¢é‚£äº›äº‚æ•¸ï¼Œä¹Ÿå°±æ˜¯ image å…§çš„æ¯å€‹å±¤ï¼ˆlayersï¼‰éƒ½ `Pull complete` æ‹‰å–å®Œæˆäº†ï¼Œä»£è¡¨æˆ‘å€‘å·²ç¶“æˆåŠŸåœ¨é‹è¡Œ ruby é€™å€‹ container äº†ã€‚

åˆ°é€™é‚Šä¸çŸ¥é“å¤§å®¶æœƒä¸æœƒè·Ÿæˆ‘ä¸€æ¨£å¥½å¥‡ï¼Œæˆ‘å‰›å‰›æ˜æ˜å°±æ˜¯ä¸‹ `ruby` é€™å€‹ image ï¼Œç‚ºä½•ä¸Šé¢çš„ log å»æ˜¯å»æ‰¾ `ruby:latest` é€™å€‹ image ? `:latest` ç©¶ç«Ÿæ˜¯ä»€éº¼ï¼Ÿå“ªä¾†çš„ï¼Ÿ

#### docker image tag

å…¶å¯¦é€™å€‹ `:latest` å°±æ˜¯ image çš„ **tag(æ¨™ç±¤)**ï¼Œæˆ‘å€‘å¯ä»¥æŠŠæˆ‘å€‘çš„ image å–åç‚ºä¸åŒçš„ tag(æ¨™ç±¤)ï¼Œæ­£å¸¸ä¾†èªªé€™å€‹ tag æœƒæ˜¯ç‰ˆæœ¬è™Ÿï¼Œè€Œç•¶æˆ‘å€‘éƒ½ä¸ç‰¹åˆ¥ä¸‹ tag æ™‚ï¼Œå‰‡æœƒå»æ‰¾é è¨­çš„ tag ï¼Œä¹Ÿå°±æ˜¯ `:latest` ï¼Œé€™å°±æ˜¯ç‚ºä»€éº¼æˆ‘å€‘ä¸Šé¢æ²’æœ‰ç‰¹åˆ¥ä¸‹ tag ä»–æœƒè‡ªå·±å»æ‰¾ `ruby:latest` çš„åŸå› ã€‚

```
docker run ruby:3.2.2
```

æˆ‘å€‘å¯ä»¥åœ¨è‡ªå·±çš„å„²å­˜åº«æˆ–æ˜¯ Docker Hub çœ‹åˆ°æœ‰å“ªäº› tag å¯ä»¥ç”¨ï¼Œå¦‚ï¼š[æœå°‹ Docker Hub ruby](https://hub.docker.com/_/ruby)ï¼Œå¯ä»¥çœ‹åˆ° Supported tagsã€‚
ä»¥ä¸Šé¢ç¯„ä¾‹ç¨‹å¼ç¢¼ç‚ºä¾‹ï¼Œå°±æ˜¯åŸ·è¡Œ ruby image 3.2.2 ç‰ˆæœ¬çš„ tagã€‚

é‚£æ—¢ç„¶æˆ‘å‰é¢æœ‰æˆåŠŸ `docker run ruby` ï¼Œæˆ‘é æœŸæˆ‘ç¾åœ¨ä½¿ç”¨ `docker ps` ä¾†æŸ¥çœ‹æˆ‘ç›®å‰é‹è¡Œä¸­çš„ container ï¼Œæœƒçœ‹åˆ°æˆ‘å‰›å‰›è·‘æˆåŠŸçš„ ruby ï¼š
![çœ‹æˆ‘ç›®å‰é‹è¡Œä¸­çš„ container](/image/dockerDay5/5_3.png)

çµæœæ€éº¼æ˜¯ç©ºçš„ï¼Ÿï¼Ÿï¼Ÿæˆ‘åˆ°åº•æœ‰æ²’æœ‰æˆåŠŸåŸ·è¡Œå•Šï¼Ÿ
æˆ‘å€‘å…ˆä½¿ç”¨ `docker ps -a` æŒ‡ä»¤ä¾†çœ‹ä¸€ä¸‹æ‰€æœ‰ container çš„ç‹€æ…‹
![çœ‹ä¸€ä¸‹æ‰€æœ‰ container çš„ç‹€æ…‹](/image/dockerDay5/5_4.png)

é€™é‚Šæœ‰çœ‹åˆ°æˆ‘çš„ ruby image ï¼Œä½†æ˜¯çœ‹çœ‹ status æ˜¯ `Exited(å·²é€€å‡º)` ï¼Œé€™æ˜¯å› ç‚º container æœƒåœ¨åŸ·è¡Œå®Œä»»å‹™å¾Œå°±é€€å‡ºï¼Œä»¥ ruby ç‚ºä¾‹ï¼Œå°±æ˜¯åœ¨åŸ·è¡Œå®Œ irbï¼ˆäº¤äº’å¼ Ruby è§£é‡‹å™¨ï¼‰å¾Œæœƒè‡ªå‹•é€€å‡ºï¼Œæ‰€ä»¥è‹¥æƒ³è¦è®“ä»–ä¸è‡ªå‹•é€€å‡ºï¼Œå°±éœ€è¦ä½¿ç”¨äº¤äº’æ¨¡å¼(å¯ä»¥é€²åˆ°å®¹å™¨å…§éƒ¨äº’å‹•)åŸ·è¡Œï¼Œæˆ–æ˜¯æœ‰å€‹è®“ä»–å¯ä»¥æŒä¹…é‹è¡Œçš„æ±è¥¿ã€‚
ç¿»æˆç™½è©±å¤§æ¦‚å°±æ˜¯ï¼Œå¦‚æœæ²’äº‹åš container å°±ä¸‹ç­ï¼Œå¦‚æœæœ‰äº‹åš container å°±æœƒåšå®Œå†ä¸‹ç­ã€‚

#### äº¤äº’æ¨¡å¼(å¯ä»¥é€²åˆ°å®¹å™¨å…§éƒ¨äº’å‹•)åŸ·è¡Œ

```
docker run -i -t ruby /bin/bash
```

ä¸Šé¢çš„æŒ‡ä»¤ä¹Ÿå¯ä»¥çœç•¥æˆå¦‚ä¸‹

```
docker run -it ruby /bin/bash
```

**-i**ï¼šä»£è¡¨ "äº¤äº’å¼"ï¼ˆInteractiveï¼‰ã€‚é€™å€‹æŒ‡ä»¤å¯ä»¥è®“ä½ è¼¸å…¥æŒ‡ä»¤ã€‚å¦‚æœæ²’æœ‰ä½¿ç”¨ -i ï¼Œå‰‡å®¹å™¨ä¸æœƒæ¥å—è¼¸å…¥çš„æŒ‡ä»¤ï¼ˆå°±æ˜¯ä½ æ€éº¼è¼¸å…¥ä»–éƒ½ä¸ç†ä½ ï¼‰ã€‚

**-t**ï¼šä»£è¡¨ "çµ‚ç«¯"ï¼ˆTerminalï¼‰ã€‚é€™å€‹æŒ‡ä»¤æ˜¯è®“ Docker ç‚ºå®¹å™¨åˆ†é…ä¸€å€‹è™›æ“¬çµ‚ç«¯å¹¾ï¼Œè®“æˆ‘å€‘å¯ä»¥åœ¨å®¹å™¨å…§éƒ¨é€²è¡Œå‘½ä»¤æ“ä½œã€‚å¦‚æœæ²’æœ‰ä½¿ç”¨ -t ï¼Œä½ å°±æƒ³åƒæˆæ²’æœ‰ä¸€å€‹å¯ä»¥æ‰“æŒ‡ä»¤çš„åœ°æ–¹ï¼ˆæ²’æœ‰çµ‚ç«¯æ©Ÿï¼‰ã€‚

**/bin/bash**:ä»£è¡¨å‘½ä»¤è§£æå™¨ï¼ˆShellï¼‰ã€‚ç”¨æ–¼è§£é‡‹å’ŒåŸ·è¡Œå‘½ä»¤ã€è…³æœ¬ä»¥åŠèˆ‡ç³»çµ±äº¤äº’çš„æ“ä½œã€‚

æ‰€ä»¥ä»¥ä¸Šæˆ‘å€‘é€šå¸¸éƒ½æœƒä¸€èµ·ä½¿ç”¨ï¼Œç›´æ¥ä½¿ç”¨ä¸Šé¢ç¯„ä¾‹çš„ä¸‹è€… `docker run -it ruby /bin/bash` å¯ä»¥å°‘æ‰“å¹¾å€‹å­—ï¼¸ï¼¤ã€‚

åŸ·è¡Œå¾Œæˆ‘å€‘å¯ä»¥çœ‹åˆ°å¯¦éš›ä¸Šæ˜¯é€²åˆ°å®¹å™¨è£¡é¢
![é€²åˆ°å®¹å™¨è£¡é¢](/image/dockerDay5/5_5.png)

æ‰€ä»¥æˆ‘å€‘å¯ä»¥åœ¨é€™å€‹æœ‰ ruby ç’°å¢ƒçš„å®¹å™¨è£¡é€²åˆ° irb ï¼Œä¸¦åŸ·è¡Œ ruby èªæ³•
![å®¹å™¨è£¡é€²åˆ° irb](/image/dockerDay5/5_6.png)

ç•¶é€™æ™‚æˆ‘å€‘å†é–‹ä¸€å€‹æ–°çš„çµ‚ç«¯æ©Ÿï¼Œä½¿ç”¨ `docker ps` å°±å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ç¾åœ¨æ­£åœ¨é‹è¡Œçš„ container äº†

![docker ps](/image/dockerDay5/5_7.png)

ä¸Šé¢æœ‰èªªé docker container æ˜¯æœ‰ **éš”é›¢æ€§** çš„ï¼Œé€™é‚Šæˆ‘å€‘å¯ä»¥çœ‹åˆ°ä¸Šé¢ä½¿ç”¨ `docker ps -a` çœ‹åˆ°å·²åœæ­¢çš„å®¹å™¨ï¼Œè·Ÿå‰é¢æˆ‘å€‘ä½¿ç”¨äº¤äº’æ¨¡å¼å¾Œï¼Œä½¿ç”¨ `docker ps` çœ‹åˆ°çš„æ­£åœ¨åŸ·è¡Œçš„å®¹å™¨ï¼Œå…©è€…çš„åç¨±åˆ†åˆ¥ç‚º `quizzical_rhode` è·Ÿ `lucid_rosalind` ï¼Œå°±å¯ä»¥èªªæ˜ä»–å€‘æ˜¯å…©å€‹ä¸åŒçš„ containerã€‚

#### å‘½åæˆ‘çš„ container

ä¸Šé¢æ—¢ç„¶èªªåˆ°åç¨±ï¼Œå¤§å®¶ä¸æœƒå¥½å¥‡é‚£æˆ‘ä¸Šé¢é‚£å…©å€‹åå­—å“ªä¾†çš„ï¼Ÿ

ç•¶æˆ‘å€‘åŸ·è¡Œ Docker å®¹å™¨è€Œä¸æŒ‡å®šåç¨±æ™‚ï¼ŒDocker æœƒæ ¹æ“šä¸€å®šçš„è¦å‰‡è‡ªå‹•ç‚ºå®¹å™¨ç”Ÿæˆä¸€å€‹å”¯ä¸€çš„åç¨±ã€‚é€™äº›è‡ªå‹•ç”Ÿæˆçš„åç¨±é€šå¸¸ç”±`å½¢å®¹è©ï¼‹åè©`çµ„æˆã€‚

ç•¶ç„¶æˆ‘å€‘ä¹Ÿå¯ä»¥è‡ªå·±å‘½åæˆ‘çš„ container

```
docker run --name my_ruby ruby
```

![å‘½åæˆ‘çš„ container](/image/dockerDay5/5_8.png)
åŸ·è¡Œä¸Šæ–¹æŒ‡ä»¤ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘æˆåŠŸå°‡æˆ‘çš„ container å–åç‚º `my_ruby`

#### èƒŒæ™¯ï¼ˆæŒä¹…ï¼‰æ¨¡å¼åŸ·è¡Œ

```
docker run -d ruby
```

é€™å€‹æŒ‡ä»¤æ˜¯å¯ä»¥åœ¨èƒŒæ™¯åŸ·è¡Œï¼Œä¹Ÿå°±æ˜¯ä¸è·‘å‡ºåŸ·è¡Œä¸­çš„ log ï¼Œè‹¥ä»¥ rails èˆ‰ä¾‹ï¼Œç•¶æˆ‘å€‘æ¯æ¬¡æ‰“é–‹ `rails s` æ™‚ï¼Œä»–éƒ½æœƒä½”ç”¨ä¸€å€‹çµ‚ç«¯æ©Ÿï¼Œè‹¥æˆ‘æƒ³è¦å¦å¤–é–‹ `rails c` æ™‚ï¼Œå°±è¦å¤šé–‹ä¸€å€‹çµ‚ç«¯æ©Ÿï¼Œé‚£åœ¨ docker æ™‚ï¼Œä½¿ç”¨ **-d** å³å¯åœ¨èƒŒæ™¯åŸ·è¡Œï¼Œä¸æœƒå¤šä½”ä¸€å€‹çµ‚ç«¯æ©Ÿçš„æ¦‚å¿µã€‚

ä»¥ä¸Šçš„æŒ‡ä»¤éƒ½å¯ä»¥æ ¹æ“šç‹€æ³çµ„åˆä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š

```
docker run -it --name ruby_test ruby
```

### åœæ­¢ Container

æˆ‘å€‘å­¸æœƒé–‹å§‹é‹è¡Œä¸€å€‹ Container ï¼Œå°±è¦çŸ¥é“å¦‚ä½•åœæ­¢å®ƒï¼Œè¦åœæ­¢ Container æœ‰å…©ç¨®æ–¹æ³•

#### åœ¨å®¹å™¨è£¡åœæ­¢

![åœ¨å®¹å™¨è£¡åœæ­¢](/image/dockerDay5/5_9.png)
è‹¥æˆ‘å€‘ä½¿ç”¨ä¸Šé¢å­¸åˆ°çš„ `docker run -it ruby /bin/bash` èªæ³•é€²åˆ°å®¹å™¨å…§ï¼Œé€™æ™‚éœ€è¦é€€å‡ºæ™‚å¯ä»¥ä½¿ç”¨

1. exit+enter
2. control+d
   æ‰“ä¸Š `exit å†æŒ‰ enter éµ` ; æˆ–æ˜¯ `æŒ‰ control éµ + d` å¯é€€å‡ºå®¹å™¨ã€‚

#### åœ¨å…¶ä»–çµ‚ç«¯æ©Ÿåœæ­¢

ä¹Ÿå¯ä»¥é–‹ä¸€å€‹æ–°çš„çµ‚ç«¯æ©Ÿï¼Œæ‰“ä¸Š

```
docker stop <container_id_or_name>
```

è‡³æ–¼å¦‚æœä¸çŸ¥é“è‡ªå·±çš„ container_id æˆ– container_name ï¼Œä½¿ç”¨å‰é¢ `docker ps` æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹æ­£åœ¨é‹è¡Œçš„ containerã€‚

### é–‹å§‹ Container

å‰›å‰›å­¸çš„ `docker stop` æŒ‡ä»¤æ˜¯ **åœæ­¢åœ¨é‹è¡Œçš„ Container** ï¼Œæ‰€ä»¥ç•¶æƒ³è¦å°‡åœæ­¢çš„ Container å†åº¦å•Ÿå‹•æ™‚ï¼Œå‰‡æ˜¯ç”¨ï¼š

```
docker start <container_id_or_name>
```

### åˆªé™¤ Container

ä½†æ˜¯ä¸¦ä¸æ˜¯æ¯å€‹åœæ­¢çš„å®¹å™¨æˆ‘å€‘éƒ½éœ€è¦å†åº¦é–‹å•Ÿçš„ï¼Œå°±åƒæ˜¯æˆ‘ä¸Šé¢ç‚ºäº†ç¤ºç¯„å»ºçš„å¾ˆå¤šä¸åŒçš„ ruby container ï¼Œæˆ‘ç¢ºå®šæˆ‘ä¸æœƒå†ä½¿ç”¨äº†ï¼Œæ‰€ä»¥æˆ‘å°±å¯ä»¥ä½¿ç”¨ä»¥ä¸‹èªæ³•å°‡å®ƒåˆªé™¤

```
docker rm <container_id_or_name>
```

ğŸ“ éœ€è¦ç‰¹åˆ¥æ³¨æ„çš„æ˜¯ï¼Œæƒ³è¦åˆªé™¤çš„ container ä¸èƒ½æ˜¯é‹è¡Œä¸­çš„ container ï¼Œè‹¥æƒ³åˆªé™¤æœƒå‡ºç¾éŒ¯èª¤è¨Šæ¯ "You cannot remove a running container"
![åˆªé™¤é‹è¡Œä¸­çš„ container](/image/dockerDay5/5_10.png)
